<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <title>Ohm’s Law Simulator – SPM</title>
  <style>
    body{font-family:Arial,Helvetica,sans-serif;background:#f0f8ff;margin:20px}
    #sim{max-width:460px;margin:auto;background:#fff;padding:20px;border-radius:10px;box-shadow:0 0 10px rgba(0,0,0,.1)}
    #controls label{display:block;margin:10px 0}
    #readings{margin:15px 0;font-size:1.1em}
    #ivGraph{border:1px solid #ccc;display:block;margin:15px auto}
  </style>
</head>
<body>
<div id="sim">
  <h2>Ohm’s Law Simulator (SPM)</h2>

  <!-- ===== CIRCUIT SVG ===== -->
  <svg width="420" height="180" viewBox="0 0 420 180">
    <!-- battery -->
    <rect x="40" y="90" width="20" height="60" fill="black"/>
    <rect x="70" y="80" width="10" height="80" fill="black"/>
    <!-- wires -->
    <line x1="60" y1="120" x2="140" y2="120" stroke="black" stroke-width="3"/>
    <line x1="260" y1="120" x2="340" y2="120" stroke="black" stroke-width="3"/>
    <line x1="340" y1="120" x2="340" y2="200" stroke="black" stroke-width="3"/>
    <line x1="340" y1="200" x2="40" y2="200" stroke="black" stroke-width="3"/>
    <line x1="40" y1="200" x2="40" y2="150" stroke="black" stroke-width="3"/>
    <!-- ammeter -->
    <circle cx="170" cy="120" r="22" stroke="#333" stroke-width="2" fill="white"/>
    <text x="170" y="125" text-anchor="middle" font-size="12">A</text>
    <line id="aNeedle" x1="170" y1="120" x2="195" y1="120" stroke="crimson" stroke-width="2"
          transform-origin="170 120"/>
    <!-- voltmeter -->
    <circle cx="230" cy="70" r="22" stroke="#333" stroke-width="2" fill="white"/>
    <text x="230" y="75" text-anchor="middle" font-size="12">V</text>
    <line id="vNeedle" x1="230" y1="70" x2="255" y1="70" stroke="royalblue" stroke-width="2"
          transform-origin="230 70"/>
    <!-- bulb -->
    <g>
      <circle cx="300" cy="120" r="18" fill="none" stroke="#555" stroke-width="2"/>
      <path d="M290 120 h20 m-20 8 h20" stroke="#666" stroke-width="2"/>
      <circle id="glow" cx="300" cy="120" r="18" fill="yellow" opacity="0"/>
    </g>
  </svg>

  <!-- ===== CONTROLS ===== -->
  <div id="controls">
    <label>Voltage (V): <input type="range" id="vSlide" min="0" max="12" step="0.1" value="6"/>
      <span id="vDisp">6.0</span> V</label>
    <label>Resistance (Ω): <input type="range" id="rSlide" min="1" max="100" step="1" value="10"/>
      <span id="rDisp">10</span> Ω</label>
  </div>

  <!-- ===== READINGS ===== -->
  <div id="readings">
    <p>Current (I): <span id="cur">0.60</span> A</p>
    <p>Voltage (V): <span id="vOut">6.0</span> V</p>
    <p>Resistance (R): <span id="rOut">10</span> Ω</p>
  </div>

  <!-- ===== I-V GRAPH ===== -->
  <canvas id="ivGraph" width="400" height="200"></canvas>
</div>

<script>
/* ========= ELEMENTS ========= */
const vSlide = document.getElementById('vSlide');
const rSlide = document.getElementById('rSlide');
const vDisp  = document.getElementById('vDisp');
const rDisp  = document.getElementById('rDisp');
const curOut = document.getElementById('cur');
const vOut   = document.getElementById('vOut');
const rOut   = document.getElementById('rOut');

const aNeedle = document.getElementById('aNeedle');
const vNeedle = document.getElementById('vNeedle');
const glow    = document.getElementById('glow');

const canvas = document.getElementById('ivGraph');
const ctx    = canvas.getContext('2d');
const data   = [];               // trace array
const maxV   = 12, maxI = 1.2;   // full-scale

/* ========= DRAW GRAPH ========= */
function drawGraph(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  // grid
  ctx.strokeStyle='#ddd'; ctx.lineWidth=1;
  for(let i=0;i<=10;i++){
     const x=(i/10)*canvas.width, y=(i/10)*canvas.height;
     ctx.beginPath(); ctx.moveTo(x,0); ctx.lineTo(x,canvas.height); ctx.stroke();
     ctx.beginPath(); ctx.moveTo(0,y); ctx.lineTo(canvas.width,y); ctx.stroke();
  }
  // axes labels
  ctx.fillStyle='#000'; ctx.font='12px sans-serif';
  ctx.fillText('V (V)',canvas.width-20,canvas.height-5);
  ctx.fillText('I (A)',2,10);
  // trace
  if(data.length<2)return;
  ctx.strokeStyle='navy'; ctx.lineWidth=2; ctx.beginPath();
  data.forEach((p,idx)=>{
     const x=(p.V/maxV)*canvas.width;
     const y=canvas.height-(p.I/maxI)*canvas.height;
     idx?ctx.lineTo(x,y):ctx.moveTo(x,y);
  });
  ctx.stroke();
}

/* ========= UPDATE ========= */
function update(){
  const V=+vSlide.value, R=+rSlide.value, I=V/R;

  // displays
  vDisp.textContent=V.toFixed(1);
  rDisp.textContent=R;
  curOut.textContent=I.toFixed(2);
  vOut.textContent=V.toFixed(1);
  rOut.textContent=R;

  // needles: -40° … +40°
  aNeedle.setAttribute('transform',`rotate(${(I/maxI)*80-40} 170 120)`);
  vNeedle.setAttribute('transform',`rotate(${(V/maxV)*80-40} 230 70)`);

  // bulb brightness
  glow.setAttribute('opacity',Math.min(I/0.8,1)*0.7);

  // graph
  data.push({V,I});
  if(data.length>150)data.shift();
  drawGraph();
}

/* ========= LISTENERS ========= */
vSlide.addEventListener('input',update);
rSlide.addEventListener('input',update);
update(); // initial
</script>
</body>
</html>
